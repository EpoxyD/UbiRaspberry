<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A layout example that shows off a responsive product landing page.">
    <title>Chick counter</title>
    
    <link rel="stylesheet" href="https://unpkg.com/purecss@0.6.2/build/pure-min.css" integrity="sha384-" crossorigin="anonymous">
    
    <!--[if lte IE 8]>
        <link rel="stylesheet" href="https://unpkg.com/purecss@0.6.2/build/grids-responsive-old-ie-min.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
        <link rel="stylesheet" href="https://unpkg.com/purecss@0.6.2/build/grids-responsive-min.css">
    <!--<![endif]-->
    
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
    
        <!--[if lte IE 8]>
            <link rel="stylesheet" href="css/layouts/marketing-old-ie.css">
        <![endif]-->
        <!--[if gt IE 8]><!-->
            <link rel="stylesheet" href="css/layouts/marketing.css">
        <!--<![endif]-->

    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
</head>
<body>
<div class="header">
    <div class="home-menu pure-menu pure-menu-horizontal pure-menu-fixed">
        <a class="pure-menu-heading" href="">Chick counter</a>
<!--
        <ul class="pure-menu-list">
            <li class="pure-menu-item pure-menu-has-children pure-menu-allow-hover">
                <a href="#" id="menuLink1" class="pure-menu-link"></a>
                <ul class="pure-menu-children">
                    <li class="pure-menu-item"><a href="#" class="pure-menu-link">Email</a></li>
                    <li class="pure-menu-item"><a href="#" class="pure-menu-link">Twitter</a></li>
                    <li class="pure-menu-item"><a href="#" class="pure-menu-link">Tumblr Blog</a></li>
                </ul>
            </li>
        </ul>
-->
    </div>
</div>

<div class="splash-container">
    <div class="splash">
        <h1 class="splash-head">Chicks inside: NaN</h1>
        <p class="splash-subhead">
            <i>Ain't Nobody Here But Us Chickens - Louis Jordan</i>

            <script>
                function play(){
                    var audio = document.getElementById("audio");
                    var icon = document.getElementById("play-button");

                    if (audio.getAttribute("playing") == "False") {
                        audio.play();
                        audio.setAttribute("playing", "True");

                        icon.className = "fa fa-pause";
                    }
                    else {
                        audio.pause();
                        audio.setAttribute("playing", "False");

                        icon.className = "fa fa-play";
                    }


                }
            </script>

            <button class="button-choose pure-button" onclick="play()"><i id="play-button" class="fa fa-play"></i></button>
            <audio playing="False" id="audio" src="audio/AintNobodyHereButUsChickens-LouisJordan.mp3" ></audio>
        </p>
    </div>
</div>

<div class="content-wrapper">
    <div class="content">
        <h2 class="content-head is-center">Your Chicks</h2>

        <div class="pure-g">

            <div class="pure-u-1 pure-u-md-1-4">
                <div class="pricing-table pricing-table-free">
                    <div class="pricing-table-header">
                        <img class="chick-img" src="img/chick_1.jpg">
                    </span>
                    </div>

                    <ul class="pricing-table-list">
                        <li><b>Chicken Little</b></li>
                        <li>Total eggs: ##</li>
                        <li>Age: ##</li>
                    </ul>

                    <button class="button-choose pure-button"><i class="fa fa-pencil"></i> Edit</button>
                </div>
            </div>

            <div class="pure-u-1 pure-u-md-1-4">
                <div class="pricing-table pricing-table-free">
                    <div class="pricing-table-header">
                        <img class="chick-img" src="img/chick_2.png">
                        </span>
                    </div>

                    <ul class="pricing-table-list">
                        <li><b>Marry Poopins</b></li>
                        <li>Total eggs: ##</li>
                        <li>Age: ##</li>
                    </ul>

                    <button class="button-choose pure-button"><i class="fa fa-pencil"></i> Edit</button>
                </div>
            </div>

            <div class="pure-u-1 pure-u-md-1-4">
                <div class="pricing-table pricing-table-free">
                    <div class="pricing-table-header">
                        <img class="chick-img" src="img/chick_3.jpg">
                        </span>
                    </div>

                    <ul class="pricing-table-list">
                        <li><b>Happy Feet</b></li>
                        <li>Total eggs: ##</li>
                        <li>Age: ##</li>
                    </ul>

                    <button class="button-choose pure-button"><i class="fa fa-pencil"></i> Edit</button>
                </div>
            </div>

            <div class="pure-u-1 pure-u-md-1-4">
                <div class="pricing-table pricing-table-free">
                    <div class="pricing-table-header">
                        <img class="chick-img" src="img/chick_4.jpg">
                        </span>
                    </div>

                    <ul class="pricing-table-list">
                        <li><b>Tom</b></li>
                        <li>Total eggs: ##</li>
                        <li>Age: ##</li>
                    </ul>

                    <button class="button-choose pure-button"><i class="fa fa-pencil"></i> Edit</button>
                </div>
            </div>


        </div>
    </div>

    <div class="ribbon l-box-lrg pure-g">
        <div id="day-night" class="l-box-lrg is-center pure-u-1 pure-u-md-1-2 pure-u-lg-2-5" style="margin-top: -4%">

        </div>

        <script>

            var svg = d3.select('#day-night').append('svg').attr('width', 422).attr('height', 200);

            svg.append("circle")
                .style("stroke", "white")
                .style("fill", "none")
                .attr("r", svg.attr('width') * 0.4)
                .attr("cx", svg.attr('width') * 0.5)
                .attr("cy", svg.attr('height'));

            var sun = svg.append('image')
                .attr('xlink:href', 'img/sun.png')
                .attr("width", 50)
                .attr("height", 50)
                .attr("x", 0)
                .attr("y", 0);

            var moon = svg.append('image')
                .attr('xlink:href', 'img/moon.png')
                .attr("width", 50)
                .attr("height", 50)
                .attr("x", 0)
                .attr("y", 0);

            var sunrise; //Time in hours
            var sunset; //Time in hours


            jQuery.ajax({
                url: "https://api.darksky.net/forecast/a22f23bee010f3976f614a0460d1ccf6/50.87296604411913,4.697816732888441",
                type: "GET",
                dataType: "jsonp",
                beforeSend: function() {

                },
                complete: function() {

                },
                success: function(resultData) {
                    var todaySunRise = new Date(resultData.daily.data[0].sunriseTime*1000);
                    var todaySunSet = new Date(resultData.daily.data[0].sunsetTime*1000);
                    var tomorrowSunRise = new Date(resultData.daily.data[1].sunriseTime*1000);
                    var now = new Date();

                    if (now >= todaySunSet && now <= tomorrowSunRise) {
                        sunrise = tomorrowSunRise;
                        sunset = todaySunSet;
                    }
                    else if (now <= todaySunSet && now >= todaySunRise) {
                        sunrise = todaySunRise;
                        sunset = todaySunSet;
                    }
                    else if (now <= todaySunRise) {
                        sunrise = todaySunRise;
                        sunset = todaySunSet;
                    }

                    sunrise = sunrise.getHours() + sunrise.getMinutes()/60;
                    sunset = sunset.getHours() + sunset.getMinutes()/60;
                    move_time(now);
                    initTimer(sunrise, sunset);

                },
                error : function(jqXHR, textStatus, errorThrown) {
                    console.log(textStatus)
                },

                timeout: 120000
            });





            var move_time = function (hours) {
                hours = hours.getHours() + hours.getMinutes()/60;

                if (hours <= sunset && hours >= sunrise) {
                    //Sun is shining, move to appropriate position
                    moon.attr('visibility', 'hidden');
                    //get position in radians
                    //half circle is devided in N pieces
                    var dayHours = sunset - sunrise;
                    var radians = Math.PI - (hours - sunrise)/dayHours * Math.PI; //Nr of radians to move to the right
                    var x = Math.cos(radians) * svg.attr('width')* 0.4 + svg.attr('width') * 0.5;
                    var y = svg.attr('height') - Math.sin(radians) * svg.attr('width') * 0.4;

                    sun.attr("transform", "translate(" + (x - sun.attr('width')/2) + "," + (y - sun.attr('height')/2)+ ")");
                    sun.attr('visibility', 'visible');
                }

                else {
                    //Nighttime, move the moon to the appropriate position
                    sun.attr('visibility', 'hidden');

                    var nightHours = sunrise + (24 - sunset);
                    if (hours <= 24 && hours >= sunset) {
                        hours = hours - sunset;
                    }
                    else {
                        hours = hours + (24 - sunset);
                    }

                    var radians = Math.PI - hours/nightHours * Math.PI; //Nr of radians to move to the right


                    var x = Math.cos(radians) * svg.attr('width')* 0.4 + svg.attr('width') * 0.5;
                    var y = svg.attr('height') - Math.sin(radians) * svg.attr('width') * 0.4;

                    moon.attr("transform", "translate(" + (x - sun.attr('width')/2) + "," + (y - sun.attr('height')/2)+ ")");
                    moon.attr('visibility', 'visible');
                }
            };


        </script>

        <div class="pure-u-1 pure-u-md-1-2 pure-u-lg-3-5" style="text-align: center; margin-top: -3%">

            <h2 class="content-head content-head-ribbon">Chickens are brave till the foxes <br> come at night</h2>

            <div class="pure-u-1" id="clockdiv">
                <div class="pure-u-1-4">
                    <span class="hours"></span>
                    <div class="smalltext">Hours</div>
                </div>
                <div class="pure-u-1-4">
                    <span class="minutes"></span>
                    <div class="smalltext">Minutes</div>
                </div>
                <div class="pure-u-1-4">
                    <span class="seconds"></span>
                    <div class="smalltext">Seconds</div>
                </div>
            </div>

        </div>

        <script>
            function getTimeRemaining(endtime) {
                var t = Date.parse(endtime) - Date.parse(new Date());
                var seconds = Math.floor((t / 1000) % 60);
                var minutes = Math.floor((t / 1000 / 60) % 60);
                var hours = Math.floor((t / (1000 * 60 * 60)) % 24);
                var days = Math.floor(t / (1000 * 60 * 60 * 24));
                return {
                    'total': t,
                    'days': days,
                    'hours': hours,
                    'minutes': minutes,
                    'seconds': seconds
                };
            }

            function initializeClock(id, endtime) {
                var clock = document.getElementById(id);
                var hoursSpan = clock.querySelector('.hours');
                var minutesSpan = clock.querySelector('.minutes');
                var secondsSpan = clock.querySelector('.seconds');

                function updateClock() {
                    var t = getTimeRemaining(endtime);

                    hoursSpan.innerHTML = ('0' + t.hours).slice(-2);
                    minutesSpan.innerHTML = ('0' + t.minutes).slice(-2);
                    secondsSpan.innerHTML = ('0' + t.seconds).slice(-2);

                    move_time(new Date());

                    if (t.total <= 0) {
                        clearInterval(timeinterval);
                    }
                }

                updateClock();
                var timeinterval = setInterval(updateClock, 1000);
            }

            function initTimer(sunrise, sunset) {
                var now = new Date();
                var hours = now.getHours();
                console.log(sunrise);
                console.log(sunset);
                var timeDiff = 0;
                if (hours < 24 && hours > sunset) {
                    timeDiff += (60 - now.getSeconds()) * 1000; //seconds
                    timeDiff += (59 - now.getMinutes()) * 60 * 1000; //minutes
                    timeDiff += (23 - now.getHours() + sunrise) * 60 * 60 * 1000;//hours
                }
                else if(hours < sunrise) {
                    timeDiff += (60 - now.getSeconds()) * 1000; //seconds
                    timeDiff += (59 - now.getMinutes()) * 60 * 1000; //minutes
                    timeDiff += (sunrise - 1 - now.getHours()) * 60 * 60 * 1000;
                }
                else if (hours >= sunrise && hours <= sunset) {
                    timeDiff += (60 - now.getSeconds()) * 1000; //seconds
                    timeDiff += (59 - now.getMinutes()) * 60 * 1000; //minutes
                    timeDiff += (sunset - 1 - now.getHours()) * 60 * 60 * 1000;//hours
                }

                var deadline = new Date(Date.parse(new Date()) + timeDiff);
                initializeClock('clockdiv', deadline);
            }

        </script>
    </div>

    <div id="loading" class="content" style="text-align: center">
        <h2 class="content-head is-center">Loading recipe of the day</h2>
        <div class="loader" style="display: inline-block; margin-top: 20px"></div>
    </div>

    <div id="dailyRecipe" class="content" style="visibility: hidden; display: none">
        <h2 id="recipeLabel" class="content-head is-center">Recipe of the day - Soft boiled eggs</h2>

        <script>

            jQuery.ajax({
                url: "https://api.edamam.com/search?q=egg&app_id=a8f2a628&app_key=7f84264a24ce3ab457a4e97e5837dc6e&from=0&to=100",
                type: "GET",

                contentType: 'application/json; charset=utf-8',
                beforeSend: function() {
                    //... your initialization code here (so show loader) ...
                },
                complete: function() {
                    var loading = document.getElementById('loading');
                    loading.setAttribute('style', 'visibility: hidden; display: none');

                    var dailyRecipe = document.getElementById('dailyRecipe');
                    dailyRecipe.setAttribute('style', 'visibility: visible;');
                },
                success: function(resultData) {
                    var totalRecipees = resultData.hits.length;
                    var randID = Math.floor(Math.random() * (totalRecipees));

                    var randRecipee = resultData.hits[randID].recipe;

                    var img = document.getElementById("recipeImg");
                    img.setAttribute("src", randRecipee.image);

                    var label = document.getElementById("recipeLabel");
                    label.innerText = "Recipe of the day - " + randRecipee.label;

                    var ingredients = randRecipee.ingredientLines;
                    var list = document.getElementById("ingrediënts");

                    for (var i = 0; i < ingredients.length; i++) {
                        var listItem = document.createElement("li");
                        listItem.appendChild(document.createTextNode(ingredients[i]));
                        list.appendChild(listItem);
                    }

                    var tags = randRecipee.healthLabels;
                    var taglist = document.getElementById("tags");

                    var html = '';
                    for (i = 0; i < tags.length; i++) {
                         html += '<div class="chip">' + tags[i] + '</div>';
                    }
                    taglist.innerHTML = html;

                },
                error : function(jqXHR, textStatus, errorThrown) {
                    console.log(textStatus)
                },

                timeout: 120000
            });

        </script>

        <div class="pure-g">

            <div class="l-box-lrg pure-u-1 pure-u-md-3-5">
                <h4>Ingrediënts</h4>

                <ul id="ingrediënts">
                </ul>

                <h4>Labels</h4>
                <div id="tags">
                </div>
            </div>

            <div class="l-box-lrg pure-u-1 pure-u-md-2-5">
                <img id="recipeImg" class="chick-img" src="img/egg.jpg"/>
            </div>

        </div>
    </div>
</div>




</body>
</html>
